- name: Install Podman and dependencies
  apt:
    name:
      - podman
    state: present
    update_cache: true

- name: Create static HTML directory
  file:
    path: /opt/static
    state: directory
    mode: '0755'

- name: Create static HTML page
  copy:
    dest: /opt/static/index.html
    content: "<h1>Welcome to Hackwell inc â€” we deploy like pros</h1>"
    mode: '0644'

- name: Run Podman container as root
  shell: |
    podman container exists static-site && podman rm -f static-site || true
    podman run -d --name static-site \
      -p 8080:80 \
      -v /opt/static:/usr/share/nginx/html:ro \
      docker.io/library/nginx:stable
  args:
    executable: /bin/bash
